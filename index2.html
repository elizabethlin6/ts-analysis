<!DOCTYPE html>
<html>
<head>
  <title>TOUR</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <div id="tree-map-container"></div>
<div id="cityInfo"></div>
  <script>

    var avgTicket = 215
    var percStadiumFilled = 0.5
    var fees = 1 - 0.1
    var takeHomeValue = avgTicket * fees

    const data = {
      name: "Root",
      children: [
        { "date": "2023-03-18", "stadium": "State Farm Stadium", "name": "Glendale, AZ", "population": 196512, "days": 2, "seats": 157200 },
        { "date": "2023-03-25", "stadium": "Allegiant Stadium", "name": "Las Vegas, NV", "population": 2150373, "days": 2, "seats": 143670 },
        { "date": "2023-04-02", "stadium": "AT&T Stadium", "name": "Arlington, TX", "population": 392304, "days": 3, "seats": 315000 },
        { "date": "2023-04-15", "stadium": "Raymond James Stadium", "name": "Tampa, FL", "population": 2683956, "days": 3, "seats": 225000 },
        { "date": "2023-04-23", "stadium": "NRG Stadium", "name": "Houston, TX", "population": 5650910, "days": 3, "seats": 240000 },
        { "date": "2023-04-30", "stadium": "Mercedes-Benz Stadium", "name": "Atlanta, GA", "population": 5046555, "days": 3, "seats": 225000 },
        { "date": "2023-05-07", "stadium": "Nissan Stadium", "name": "Nashville, TN", "population": 1098486, "days": 3, "seats": 207429 },
        { "date": "2023-05-14", "stadium": "Lincoln Financial Field", "name": "Philadelphia, PA", "population": 5512873, "days": 3, "seats": 209688 },
        { "date": "2023-05-21", "stadium": "Gillette Stadium", "name": "Foxborough, MA", "population": 16693, "days": 3, "seats": 197634 },
        { "date": "2023-05-28", "stadium": "MetLife Stadium", "name": "East Rutherford, NJ", "population": 9918, "days": 3, "seats": 265473 },
        { "date": "2023-06-04", "stadium": "Soldier Field", "name": "Chicago, IL", "population": 4576, "days": 3, "seats": 184500 },
        { "date": "2023-06-10", "stadium": "Ford Field", "name": "Detroit, MI", "population": 3522856, "days": 2, "seats": 156000 },
        { "date": "2023-06-17", "stadium": "Acrisure Stadium", "name": "Pittsburgh, PA", "population": 1720279, "days": 2, "seats": 150000 },
        { "date": "2023-06-24", "stadium": "U.S. Bank Stadium", "name": "Minneapolis, MN", "population": 2856952, "days": 2, "seats": 146000 },
        { "date": "2023-07-01", "stadium": "Paycor Stadium", "name": "Cincinnati, OH", "population": 1712287, "days": 2, "seats": 131030 },
        { "date": "2023-07-08", "stadium": "GEHA Field", "name": "Kansas City, MO", "population": 155745, "days": 2, "seats": 152832 },
        { "date": "2023-07-15", "stadium": "Empower Field", "name": "Denver, CO", "population": 2650725, "days": 2, "seats": 168000 },
        { "date": "2023-07-23", "stadium": "Lumen Field", "name": "Seattle, WA", "population": 3438221, "days": 2, "seats": 144000 },
        { "date": "2023-07-29", "stadium": "Levi's Stadium", "name": "Santa Clara, CA", "population": 127922, "days": 2, "seats": 137000 },
        { "date": "2023-08-09", "stadium": "Sofi Stadium", "name": "Los Angeles, CA", "population": 12121244, "days": 6, "seats": 501200 }
      ]
    };

    const width = 1000;
    const height = 500;

    const treemapLayout = d3.treemap()
      .size([width, height])
      .padding(2);

    const root = d3.hierarchy(data).sum(d => d.seats || 0);

    treemapLayout(root);

    const svg = d3.select("#tree-map-container")
      .append("svg")
      .attr("width", width)
      .attr("height", height);

    const cell = svg.selectAll("g")
      .data(root.leaves())
      .enter()
      .append("g")
      .attr("transform", d => `translate(${d.x0},${d.y0})`)
      .on("mouseenter", handleMouseEnter) // Add event listener for mouseenter
      .on("mouseleave", handleMouseLeave); // Add event listener for mouseleave

    cell.append("rect")
      .attr("width", d => d.x1 - d.x0)
      .attr("height", d => d.y1 - d.y0)
      .attr("fill", function() {
    return "hsl(" + Math.random() * 1000 + ",30%,50%)";
    });

    cell.append("text")
      .attr("x", 5)
      .attr("y", 10)
      .text(d => d.data.name)

    cell.append("text")
      .attr("x", 5)
      .attr("y", 40)
      .text(d => `Revenue: $${Math.round(d.data.seats * percStadiumFilled * d.data.days * takeHomeValue / 1000000)}M`)



    // Function to handle mouseenter event
    function handleMouseEnter(event, d) {
      d3.select(this).select("rect")
        .attr("fill", "orange"); // Change fill color when hovering
        document.getElementById("cityInfo").innerHTML = 
        "City: " + d.data.name + "<br>" +
        "Stadium: " + d.data.stadium + "<br>" +
        "Population: " + d.data.population + "<br>" +
        "Seats: " + d.data.seats + "<br>" +
        "Days: " + d.data.days
    }

    // Function to handle mouseleave event
    function handleMouseLeave(event, d) {
      d3.select(this).select("rect")
        .attr("fill", "steelblue"); // Revert fill color when leaving
    }
  </script>
</body>
</html>